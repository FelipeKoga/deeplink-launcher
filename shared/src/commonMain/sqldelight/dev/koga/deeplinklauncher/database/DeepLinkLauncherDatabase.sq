CREATE TABLE deeplink(
  id TEXT NOT NULL PRIMARY KEY,
  link TEXT NOT NULL,
  name TEXT,
  description TEXT,
  createdAt INTEGER NOT NULL,
  folderId TEXT,
  isFavorite INTEGER DEFAULT 0,
  FOREIGN KEY(folderId) REFERENCES folder(id)
);

CREATE TABLE folder (
    id TEXT PRIMARY KEY,
    name TEXT UNIQUE NOT NULL,
    description TEXT,
    color TEXT
);


selectDeeplinks:
SELECT d.*, f.*
FROM deeplink d
LEFT JOIN folder f ON d.folderId = f.id
WHERE d.link LIKE ? OR d.name LIKE ? OR d.description LIKE ?
ORDER BY createdAt DESC;

deleteDeeplinkById:
DELETE FROM deeplink WHERE id = ?;

favoriteDeepLinkById:
UPDATE deeplink SET isFavorite = ? WHERE id = ?;

upsertDeeplink:
INSERT OR REPLACE INTO deeplink (id, link, name, description, createdAt, isFavorite, folderId)
VALUES (?, ?, ?, ?, ?, ?, ?);

getDeepLinkByLink:
SELECT d.*, f.*
FROM deeplink d
LEFT JOIN folder f ON d.folderId = f.id
WHERE d.link = ?;

getDeepLinkById:
SELECT d.*, f.*
FROM deeplink d
LEFT JOIN folder f ON d.folderId = f.id
WHERE d.id = ?;


selectAllFolders:
SELECT * FROM folder;

upsertFolder:
INSERT OR REPLACE INTO folder (id, name, description, color)
VALUES (?, ?, ?, ?);

deleteFolderById:
DELETE FROM folder WHERE id = ?;